<!DOCTYPE html>
<html>
    <h1 id="creep">CREEP:</h1>
    <h1 id="fp">FP: </h1>
    <h1 id="fuzzy">Fuzzy: </h1>
    <div id="output"></div>
</html>


<script type="module">

    import { main } from  "./U235.mjs";

    const flattenObject = (obj, parentKey = '', result = {}) => {
    for (let key in obj) {
        if (obj.hasOwnProperty(key)) {
            let newKey = parentKey ? `${parentKey}.${key}` : key;
            if (typeof obj[key] === 'object' && obj[key] !== null && !Array.isArray(obj[key])) {
                flattenObject(obj[key], newKey, result);
            } else {
                result[newKey] = obj[key];
            }
        }
    }
    return result;
};

    main().then((that) => {
        document.querySelector("#creep").innerText = `CREEP: ${that.creepHash}`;
        document.querySelector("#fp").innerText = `FP: ${that.fpHash}`;
        document.querySelector("#fuzzy").innerText = `WAG: ${that.fuzzyHash}`;
        
        console.log(that);
        let flat = flattenObject(that.creep);

        let testArray = [
            "canvasWebgl.parameters.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",
            "canvasWebgl.parameters.MAX_COLOR_ATTACHMENTS",
            "canvasWebgl.parameters.MAX_DRAW_BUFFERS_WEBGL",
            "canvasWebgl.parameters.MAX_DRAW_BUFFERS",
            "canvasWebgl.parameters.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",
            "canvasWebgl.parameters.MAX_SAMPLES",
            "canvasWebgl.parameters.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",
            "canvasWebgl.parameters.MAX_UNIFORM_BLOCK_SIZE",
            "canvasWebgl.parameters.MAX_VARYING_COMPONENTS",
            //"canvasWebgl.parameters.MAX_VERTEX_OUTPUT_COMPONENTS",
            //"canvasWebgl.parameters.MAX_VERTEX_UNIFORM_COMPONENTS",
            "cssMedia.invertedColors",
            "cssMedia.hover",
            "cssMedia.forcedColors",
            "cssMedia.colorScheme",
            "cssMedia.colorGamut",
            "cssMedia.anyPointer",
            "cssMedia.anyHover",
            "navigator.device",
            "navigator.system",
            "navigator.platform",
        ]

        Object.keys(flat).sort((a,b) => {return a > b ? -1 : 1}).forEach((key) => {
            if(typeof flat[key] !== "object"){
                if(1 === 1){
                    let el = document.createElement("p");
                    el.innerText = `${key}: ${flat[key]}`;
                    document.querySelector("#output").appendChild(el);
                }

            } else if  (Array.isArray(flat[key])) {
                //let el = document.createElement("p");
                //el.innerText = `${key}: ${JSON.stringify(flat[key].sort())}`;
                //document.querySelector("#output").appendChild(el);
            }
        })
    });



</script>